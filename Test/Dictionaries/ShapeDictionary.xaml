<!-- Copyright (c) Wiesław Šoltés. All rights reserved. -->
<!-- Licensed under the MIT license. See LICENSE file in the project root for full license information. -->
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:core="clr-namespace:Test2d;assembly=Test2d"
                    xmlns:converters="clr-namespace:Test.Converters">
    <ControlTemplate x:Key="PropertiesControlTemplateKey">
         <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <Menu Background="Transparent" HorizontalAlignment="Right" Grid.Row="0" Margin="2,0,2,0">
                <MenuItem Command="{Binding DataContext.Commands.AddPropertyCommand, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}}" CommandParameter="{Binding}" Header="+"/>
            </Menu>
            <ItemsControl VerticalContentAlignment="Stretch" VerticalAlignment="Stretch" Grid.Row="1"
                          ItemsSource="{Binding Properties, UpdateSourceTrigger=PropertyChanged}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Grid Height="Auto" VerticalAlignment="Top">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="70"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="22"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition/>
                                <RowDefinition/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <TextBox Grid.Column="0" Grid.Row="0" Margin="2,1,2,1" VerticalAlignment="Center" 
                                     Text="{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Delay=500}"/>
                            <TextBox Grid.Column="1" Grid.Row="0" Margin="0,1,0,1" VerticalAlignment="Center" 
                                     Text="{Binding Data, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Delay=500}"/>
                            <Button Grid.Column="2" Grid.Row="0" Margin="2,1,2,1" VerticalAlignment="Center" Content="-" 
                                    Command="{Binding DataContext.Commands.RemovePropertyCommand, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}}"
                                    CommandParameter="{Binding}">
                            </Button>
                        </Grid>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </Grid>
    </ControlTemplate>
    <ControlTemplate x:Key="StateControlTemplateKey">
        <ControlTemplate.Resources>
            <converters:FlagsEnumConverter x:Key="FlagsEnumConverter"/>
        </ControlTemplate.Resources>
        <StackPanel>
            <CheckBox Content="Default" Margin="1"
                      IsChecked="{Binding Path=State, Converter={StaticResource FlagsEnumConverter}, ConverterParameter={x:Static core:ShapeState.Default}}">
            </CheckBox>
            <CheckBox Content="Visible" Margin="1"
                      IsChecked="{Binding Path=State, Converter={StaticResource FlagsEnumConverter}, ConverterParameter={x:Static core:ShapeState.Visible}}">
            </CheckBox>
            <CheckBox Content="Printable" Margin="1"
                      IsChecked="{Binding Path=State, Converter={StaticResource FlagsEnumConverter}, ConverterParameter={x:Static core:ShapeState.Printable}}">
            </CheckBox>
            <CheckBox Content="Locked" Margin="1"
                      IsChecked="{Binding Path=State, Converter={StaticResource FlagsEnumConverter}, ConverterParameter={x:Static core:ShapeState.Locked}}">
            </CheckBox>
            <CheckBox Content="Connector" Margin="1"
                      IsChecked="{Binding Path=State, Converter={StaticResource FlagsEnumConverter}, ConverterParameter={x:Static core:ShapeState.Connector}}">
            </CheckBox>
            <CheckBox Content="None" Margin="1"
                      IsChecked="{Binding Path=State, Converter={StaticResource FlagsEnumConverter}, ConverterParameter={x:Static core:ShapeState.None}}">
            </CheckBox>
            <CheckBox Content="Standalone" Margin="1"
                      IsChecked="{Binding Path=State, Converter={StaticResource FlagsEnumConverter}, ConverterParameter={x:Static core:ShapeState.Standalone}}">
            </CheckBox>
            <CheckBox Content="Input" Margin="1"
                      IsChecked="{Binding Path=State, Converter={StaticResource FlagsEnumConverter}, ConverterParameter={x:Static core:ShapeState.Input}}">
            </CheckBox>
            <CheckBox Content="Output" Margin="1"
                      IsChecked="{Binding Path=State, Converter={StaticResource FlagsEnumConverter}, ConverterParameter={x:Static core:ShapeState.Output}}">
            </CheckBox>
        </StackPanel>
    </ControlTemplate>
    <DataTemplate DataType="{x:Type core:ShapeStyle}">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="30"/>
            </Grid.ColumnDefinitions>
            <ComboBox ItemsSource="{Binding Path=DataContext.Editor.Project.CurrentStyleGroup.Styles, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}}" 
                      SelectedItem="{Binding Path=DataContext.Style, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Expander}}}" 
                      Grid.Row="0" 
                      Grid.Column="0" 
                      Grid.ColumnSpan="2"
                      Margin="0,1,0,1">
                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding Name, UpdateSourceTrigger=PropertyChanged, Delay=500}"/>
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>
        </Grid>
    </DataTemplate>
    <DataTemplate DataType="{x:Type core:XPoint}">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="80"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="30"/>
            </Grid.ColumnDefinitions>
            <TextBlock Text="X" 
                       Margin="5" 
                       Grid.Row="0" 
                       Grid.Column="0" 
                       TextAlignment="Left" 
                       VerticalAlignment="Center">
            </TextBlock>
            <TextBlock Text="Y" 
                       Margin="5" 
                       Grid.Row="1" 
                       Grid.Column="0" 
                       TextAlignment="Left" 
                       VerticalAlignment="Center">
            </TextBlock>
            <TextBox Text="{Binding X, UpdateSourceTrigger=PropertyChanged, Delay=500}" 
                     BorderBrush="{x:Null}" 
                     Grid.Row="0" 
                     Grid.Column="1" 
                     Grid.ColumnSpan="2"
                     TextAlignment="Center" 
                     VerticalAlignment="Center">
            </TextBox>
            <TextBox Text="{Binding Y, UpdateSourceTrigger=PropertyChanged, Delay=500}" 
                     BorderBrush="{x:Null}" 
                     Grid.Row="1" 
                     Grid.Column="1" 
                     Grid.ColumnSpan="2"
                     TextAlignment="Center" 
                     VerticalAlignment="Center">
            </TextBox>
            <Expander Header="Shape" IsExpanded="False"
                      Grid.Row="2" 
                      Grid.Column="0" 
                      Grid.ColumnSpan="3">
                <ContentControl Content="{Binding Shape}"/>
            </Expander>
            <Expander Header="State" IsExpanded="True"
                      Grid.Row="3" 
                      Grid.Column="0"
                      Grid.ColumnSpan="3">
                <Control Template="{StaticResource StateControlTemplateKey}"/>
            </Expander>
            <Expander Header="Properties" IsExpanded="False" 
                      Grid.Row="4" 
                      Grid.Column="0"
                      Grid.ColumnSpan="3">
                <Control Template="{StaticResource PropertiesControlTemplateKey}"/>
            </Expander>
        </Grid>
    </DataTemplate>
    <DataTemplate DataType="{x:Type core:XLine}">
        <StackPanel>
            <Expander Header="Style" IsExpanded="True">
                <ContentControl Content="{Binding Style}"/>
            </Expander>
            <Expander Header="Start" IsExpanded="False">
                <ContentControl Content="{Binding Start}"/>
            </Expander>
            <Expander Header="End" IsExpanded="False">
                <ContentControl Content="{Binding End}"/>
            </Expander>
            <Expander Header="State" IsExpanded="True">
                <Control Template="{StaticResource StateControlTemplateKey}"/>
            </Expander>
            <Expander Header="Properties" IsExpanded="True">
                <Control Template="{StaticResource PropertiesControlTemplateKey}"/>
            </Expander>
        </StackPanel>
    </DataTemplate>
    <DataTemplate DataType="{x:Type core:XRectangle}">
        <StackPanel>
            <Expander Header="Style" IsExpanded="True">
                <ContentControl Content="{Binding Style}"/>
            </Expander>
            <Expander Header="TopLeft" IsExpanded="False">
                <ContentControl Content="{Binding TopLeft}"/>
            </Expander>
            <Expander Header="BottomRight" IsExpanded="False">
                <ContentControl Content="{Binding BottomRight}"/>
            </Expander>
            <Expander Header="Fill" IsExpanded="False">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="80"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="30"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="IsFilled" 
                               Margin="0,0,2,0" 
                               Grid.Row="0"
                               Grid.Column="0" 
                               TextAlignment="Left" 
                               VerticalAlignment="Center">
                    </TextBlock>
                    <CheckBox Content=""
                              IsChecked="{Binding IsFilled}"
                              Grid.Row="0" 
                              Grid.Column="1" 
                              Grid.ColumnSpan="2"
                              Margin="0,1,0,1">
                    </CheckBox>
                </Grid>
            </Expander>
            <Expander Header="State" IsExpanded="True">
                <Control Template="{StaticResource StateControlTemplateKey}"/>
            </Expander>
            <Expander Header="Properties" IsExpanded="True">
                <Control Template="{StaticResource PropertiesControlTemplateKey}"/>
            </Expander> 
        </StackPanel>
    </DataTemplate>
    <DataTemplate DataType="{x:Type core:XEllipse}">
        <StackPanel>
            <Expander Header="Style" IsExpanded="True">
                <ContentControl Content="{Binding Style}"/>
            </Expander>
            <Expander Header="TopLeft" IsExpanded="False">
                <ContentControl Content="{Binding TopLeft}"/>
            </Expander>
            <Expander Header="BottomRight" IsExpanded="False">
                <ContentControl Content="{Binding BottomRight}"/>
            </Expander>
            <Expander Header="Fill" IsExpanded="False">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="80"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="30"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="IsFilled" 
                               Margin="0,0,2,0" 
                               Grid.Row="0"
                               Grid.Column="0" 
                               TextAlignment="Left" 
                               VerticalAlignment="Center">
                    </TextBlock>
                    <CheckBox Content=""
                              IsChecked="{Binding IsFilled}"
                              Grid.Row="0" 
                              Grid.Column="1" 
                              Grid.ColumnSpan="2"
                              Margin="0,1,0,1">
                    </CheckBox>
                </Grid>
            </Expander>
            <Expander Header="State" IsExpanded="True">
                <Control Template="{StaticResource StateControlTemplateKey}"/>
            </Expander>
            <Expander Header="Properties" IsExpanded="True">
                <Control Template="{StaticResource PropertiesControlTemplateKey}"/>
            </Expander>
        </StackPanel>
    </DataTemplate>
    <DataTemplate DataType="{x:Type core:XArc}">
        <StackPanel>
            <Expander Header="Style" IsExpanded="True">
                <ContentControl Content="{Binding Style}"/>
            </Expander>
            <Expander Header="Point1" IsExpanded="False">
                <ContentControl Content="{Binding Point1}"/>
            </Expander>
            <Expander Header="Point2" IsExpanded="False">
                <ContentControl Content="{Binding Point2}"/>
            </Expander>
            <Expander Header="Point3" IsExpanded="False">
                <ContentControl Content="{Binding Point3}"/>
            </Expander>
            <Expander Header="Point4" IsExpanded="False">
                <ContentControl Content="{Binding Point4}"/>
            </Expander>
            <Expander Header="Fill" IsExpanded="False">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="80"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="30"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="IsFilled" 
                               Margin="0,0,2,0" 
                               Grid.Row="0"
                               Grid.Column="0" 
                               TextAlignment="Left" 
                               VerticalAlignment="Center">
                    </TextBlock>
                    <CheckBox Content=""
                              IsChecked="{Binding IsFilled}"
                              Grid.Row="0" 
                              Grid.Column="1" 
                              Grid.ColumnSpan="2"
                              Margin="0,1,0,1">
                    </CheckBox>
                </Grid>
            </Expander>
            <Expander Header="State" IsExpanded="True">
                <Control Template="{StaticResource StateControlTemplateKey}"/>
            </Expander>
            <Expander Header="Properties" IsExpanded="True">
                <Control Template="{StaticResource PropertiesControlTemplateKey}"/>
            </Expander> 
        </StackPanel>
    </DataTemplate>
    <DataTemplate DataType="{x:Type core:XBezier}">
        <StackPanel>
            <Expander Header="Style" IsExpanded="True">
                <ContentControl Content="{Binding Style}"/>
            </Expander>
            <Expander Header="Point1" IsExpanded="False">
                <ContentControl Content="{Binding Point1}"/>
            </Expander>
            <Expander Header="Point2" IsExpanded="False">
                <ContentControl Content="{Binding Point2}"/>
            </Expander>
            <Expander Header="Point3" IsExpanded="False">
                <ContentControl Content="{Binding Point3}"/>
            </Expander>
            <Expander Header="Point4" IsExpanded="False">
                <ContentControl Content="{Binding Point4}"/>
            </Expander>
            <Expander Header="Fill" IsExpanded="False">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="80"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="30"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="IsFilled" 
                               Margin="0,0,2,0" 
                               Grid.Row="0"
                               Grid.Column="0" 
                               TextAlignment="Left" 
                               VerticalAlignment="Center">
                    </TextBlock>
                    <CheckBox Content=""
                              IsChecked="{Binding IsFilled}"
                              Grid.Row="0" 
                              Grid.Column="1" 
                              Grid.ColumnSpan="2"
                              Margin="0,1,0,1">
                    </CheckBox>
                </Grid>
            </Expander>
            <Expander Header="State" IsExpanded="True">
                <Control Template="{StaticResource StateControlTemplateKey}"/>
            </Expander>
            <Expander Header="Properties" IsExpanded="True">
                <Control Template="{StaticResource PropertiesControlTemplateKey}"/>
            </Expander> 
        </StackPanel>
    </DataTemplate>
    <DataTemplate DataType="{x:Type core:XQBezier}">
        <StackPanel>
            <Expander Header="Style" IsExpanded="True">
                <ContentControl Content="{Binding Style}"/>
            </Expander>
            <Expander Header="Point1" IsExpanded="False">
                <ContentControl Content="{Binding Point1}"/>
            </Expander>
            <Expander Header="Point2" IsExpanded="False">
                <ContentControl Content="{Binding Point2}"/>
            </Expander>
            <Expander Header="Point3" IsExpanded="False">
                <ContentControl Content="{Binding Point3}"/>
            </Expander>
            <Expander Header="Fill" IsExpanded="False">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="80"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="30"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="IsFilled" 
                               Margin="0,0,2,0" 
                               Grid.Row="0"
                               Grid.Column="0" 
                               TextAlignment="Left" 
                               VerticalAlignment="Center">
                    </TextBlock>
                    <CheckBox Content=""
                              IsChecked="{Binding IsFilled}"
                              Grid.Row="0" 
                              Grid.Column="1" 
                              Grid.ColumnSpan="2"
                              Margin="0,1,0,1">
                    </CheckBox>
                </Grid>
            </Expander>
            <Expander Header="State" IsExpanded="True">
                <Control Template="{StaticResource StateControlTemplateKey}"/>
            </Expander>
            <Expander Header="Properties" IsExpanded="True">
                <Control Template="{StaticResource PropertiesControlTemplateKey}"/>
            </Expander>
        </StackPanel>
    </DataTemplate>
    <DataTemplate DataType="{x:Type core:XText}">
        <StackPanel>
            <Expander Header="Style" IsExpanded="True">
                <ContentControl Content="{Binding Style}"/>
            </Expander>
            <Expander Header="TopLeft" IsExpanded="False">
                <ContentControl Content="{Binding TopLeft}"/>
            </Expander>
            <Expander Header="BottomRight" IsExpanded="False">
                <ContentControl Content="{Binding BottomRight}"/>
            </Expander>
            <Expander Header="Fill" IsExpanded="False">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="80"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="30"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="IsFilled" 
                               Margin="0,0,2,0" 
                               Grid.Row="0"
                               Grid.Column="0" 
                               TextAlignment="Left" 
                               VerticalAlignment="Center">
                    </TextBlock>
                    <CheckBox Content=""
                              IsChecked="{Binding IsFilled}"
                              Grid.Row="0" 
                              Grid.Column="1" 
                              Grid.ColumnSpan="2"
                              Margin="0,1,0,1">
                    </CheckBox>
                </Grid>
            </Expander>
            <Expander Header="TextBinding" IsExpanded="False">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="30"/>
                    </Grid.ColumnDefinitions>
                    <TextBox Text="{Binding TextBinding, UpdateSourceTrigger=PropertyChanged, Delay=500}" 
                             BorderBrush="{x:Null}" 
                             Grid.Row="0" 
                             Grid.Column="0" 
                             Grid.ColumnSpan="2"
                             TextAlignment="Left" 
                             VerticalAlignment="Center">
                    </TextBox>
                </Grid>
            </Expander>
            <Expander Header="Text" IsExpanded="True">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="30"/>
                    </Grid.ColumnDefinitions>
                    <TextBox Text="{Binding Text, UpdateSourceTrigger=PropertyChanged, Delay=500}" 
                             BorderBrush="{x:Null}" 
                             Grid.Row="0" 
                             Grid.Column="0" 
                             Grid.ColumnSpan="2"
                             TextAlignment="Left" 
                             VerticalAlignment="Center">
                    </TextBox>
                </Grid>
            </Expander>
            <Expander Header="State" IsExpanded="True">
                <Control Template="{StaticResource StateControlTemplateKey}"/>
            </Expander>
            <Expander Header="Properties" IsExpanded="True">
                <Control Template="{StaticResource PropertiesControlTemplateKey}"/>
            </Expander>
        </StackPanel>
    </DataTemplate>
    <DataTemplate DataType="{x:Type core:XImage}">
        <StackPanel>
            <Expander Header="Style" IsExpanded="True">
                <ContentControl Content="{Binding Style}"/>
            </Expander>
            <Expander Header="TopLeft" IsExpanded="False">
                <ContentControl Content="{Binding TopLeft}"/>
            </Expander>
            <Expander Header="BottomRight" IsExpanded="False">
                <ContentControl Content="{Binding BottomRight}"/>
            </Expander>
            <Expander Header="Path" IsExpanded="False">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="30"/>
                    </Grid.ColumnDefinitions>
                    <TextBox Text="{Binding Path, UpdateSourceTrigger=PropertyChanged, Delay=500}" 
                             BorderBrush="{x:Null}" 
                             Grid.Row="0" 
                             Grid.Column="0" 
                             Grid.ColumnSpan="2"
                             TextAlignment="Left" 
                             VerticalAlignment="Center">
                    </TextBox>
                </Grid>
            </Expander>
            <Expander Header="Fill" IsExpanded="False">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="80"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="30"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="IsFilled" 
                               Margin="0,0,2,0" 
                               Grid.Row="0"
                               Grid.Column="0" 
                               TextAlignment="Left" 
                               VerticalAlignment="Center">
                    </TextBlock>
                    <CheckBox Content=""
                              IsChecked="{Binding IsFilled}"
                              Grid.Row="0" 
                              Grid.Column="1" 
                              Grid.ColumnSpan="2"
                              Margin="0,1,0,1">
                    </CheckBox>
                </Grid>
            </Expander>
            <Expander Header="State" IsExpanded="True">
                <Control Template="{StaticResource StateControlTemplateKey}"/>
            </Expander>
            <Expander Header="Properties" IsExpanded="True">
                <Control Template="{StaticResource PropertiesControlTemplateKey}"/>
            </Expander>
        </StackPanel>
    </DataTemplate>
    <DataTemplate DataType="{x:Type core:XGroup}">
        <StackPanel>
            <Expander Header="Name" IsExpanded="True">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="30"/>
                    </Grid.ColumnDefinitions>
                    <TextBox Text="{Binding Name, UpdateSourceTrigger=PropertyChanged, Delay=500}" 
                             BorderBrush="{x:Null}" 
                             Grid.Row="0" 
                             Grid.Column="0" 
                             Grid.ColumnSpan="2"
                             TextAlignment="Left" 
                             VerticalAlignment="Center">
                    </TextBox>
                </Grid>
            </Expander>
            <Expander Header="Shapes" IsExpanded="False">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <ListBox x:Name="shapesListBox"
                             ItemsSource="{Binding Shapes}"
                             BorderBrush="{x:Null}"
                             Grid.Row="0">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding}" Margin="0,5,0,5"/>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                    <ContentControl Content="{Binding ElementName=shapesListBox, Path=SelectedItem}" 
                                    Grid.Row="1" Margin="2">
                    </ContentControl>
                </Grid>
            </Expander>
            <Expander Header="Connectors" IsExpanded="False">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <ListBox x:Name="connectorsListBox"
                             ItemsSource="{Binding Connectors}"
                             BorderBrush="{x:Null}"
                             Grid.Row="0">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding}" Margin="0,5,0,5"/>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                    <ContentControl Content="{Binding ElementName=connectorsListBox, Path=SelectedItem}" 
                                    Grid.Row="1" Margin="2">
                    </ContentControl>
                </Grid>
            </Expander>
            <Expander Header="State" IsExpanded="True">
                <Control Template="{StaticResource StateControlTemplateKey}"/>
            </Expander>
            <Expander Header="Properties" IsExpanded="True">
                <Control Template="{StaticResource PropertiesControlTemplateKey}"/>
            </Expander>
            <Expander Header="Database" IsExpanded="True">
                <ItemsControl VerticalContentAlignment="Stretch" VerticalAlignment="Stretch" 
                              ItemsSource="{Binding Database, UpdateSourceTrigger=PropertyChanged}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Grid Height="Auto" VerticalAlignment="Top">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="70"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Column="0" Grid.Row="0" Margin="0,1,2,1" HorizontalAlignment="Right" VerticalAlignment="Center" Text="{Binding Key}"/>
                                <TextBox Grid.Column="1" Grid.Row="0" Margin="0,1,0,1" VerticalAlignment="Center" Text="{Binding Value.Data, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Delay=500}"/>
                            </Grid>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </Expander>
        </StackPanel>
    </DataTemplate>
</ResourceDictionary>
