{
  "$id": "1",
  "$type": "Test2d.ShapeCode, Test2d",
  "IsExecutable": true,
  "Definitions": "BoolSimulationFactory factory;\r\nIDictionary<XGroup, BoolSimulation> simulations;",
  "Initialization": "try\r\n{\r\n    var all = context.Editor.Project.Documents\r\n        .SelectMany(d => d.Containers)\r\n        .SelectMany(c => c.Layers)\r\n        .SelectMany(l => l.Shapes);\r\n    if (all != null)\r\n    {\r\n        var graph = ContainerGraph.Create(all);\r\n        if (graph != null)\r\n        {\r\n            factory = new BoolSimulationFactory();\r\n            factory.Register(new SignalSimulation());\r\n            factory.Register(new InputSimulation());\r\n            factory.Register(new OutputSimulation());\r\n            factory.Register(new ShortcutSimulation());\r\n            factory.Register(new AndSimulation());\r\n            factory.Register(new OrSimulation());\r\n            factory.Register(new InverterSimulation());\r\n            factory.Register(new XorSimulation());\r\n            factory.Register(new TimerOnSimulation());\r\n            factory.Register(new TimerOffSimulation());\r\n            factory.Register(new TimerPulseSimulation());\r\n            factory.Register(new MemoryResetPriorityVSimulation());\r\n            factory.Register(new MemorySetPriorityVSimulation());\r\n            factory.Register(new MemoryResetPrioritySimulation());\r\n            factory.Register(new MemorySetPrioritySimulation());\r\n\r\n            simulations = factory.Create(graph);\r\n        }\r\n    }\r\n}\r\ncatch (Exception ex)\r\n{\r\n    if (context.Editor.Log != null)\r\n    {\r\n        context.Editor.Log.LogError(\"{0}{1}{2}\",\r\n            ex.Message,\r\n            Environment.NewLine,\r\n            ex.StackTrace);\r\n    }\r\n}",
  "Script": "try\r\n{\r\n    if (factory != null && simulations != null)\r\n    {\r\n        factory.Run(simulations, context.Clock);\r\n    }\r\n\r\n    shape.Text = context.Clock.Cycle.ToString();\r\n}\r\ncatch (Exception ex)\r\n{\r\n    if (context.Editor.Log != null)\r\n    {\r\n        context.Editor.Log.LogError(\"{0}{1}{2}\",\r\n            ex.Message,\r\n            Environment.NewLine,\r\n            ex.StackTrace);\r\n    }\r\n}"
}